{"version":3,"file":"src_app_layouts_user_messages_messages_module_ts.js","mappings":"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","sources":["./src/app/layouts/user/messages/messages-chat/messages-chat.component.ts","./src/app/layouts/user/messages/messages-chat/messages-chat.component.html","./src/app/layouts/user/messages/messages-routing.module.ts","./src/app/layouts/user/messages/messages.module.ts"],"sourcesContent":["import { Component, ElementRef, EventEmitter, HostListener, OnInit, Output, ViewChild } from '@angular/core';\r\nimport { AngularFireStorage } from '@angular/fire/compat/storage';\r\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport * as moment from 'moment';\r\nimport { Subject } from 'rxjs';\r\nimport { AuthService } from 'src/app/service/auth.service';\r\nimport { KindergartenListService } from 'src/app/service/kindergarten-list.service';\r\nimport { contacts } from 'src/app/shared/interfaces/contacts.interface';\r\nimport { Files } from 'src/app/shared/interfaces/file.interface';\r\nimport { Users } from 'src/app/shared/interfaces/users.interface';\r\n\r\n@Component({\r\n  selector: 'app-messages-chat',\r\n  templateUrl: './messages-chat.component.html',\r\n  styleUrls: ['./messages-chat.component.scss']\r\n})\r\nexport class MessagesChatComponent implements OnInit {\r\n  @ViewChild('scroll') private myScrollContainer: ElementRef;\r\n  mainUser: Users;\r\n  uplFile: Files;\r\n  isDisabled: boolean = false;\r\n  currMesUser: contacts;\r\n  currDate: string = '';\r\n  allUsers: Array<Users>;\r\n  userContacts: Array<contacts> = [];\r\n  checkOption: number = null;\r\n  deleteIndex: number = null;\r\n  textInput: FormGroup = new FormGroup({\r\n    text: new FormControl('', [Validators.required]),\r\n  });\r\n  deleteForm: FormGroup = new FormGroup({\r\n    checkbox: new FormControl(false)\r\n  })\r\n  subject: Subject<string> = new Subject<string>();\r\n  userMessname: string;\r\n  // month: Array<Month> = [];\r\n  editMessage: number = null;\r\n  isEdit: boolean = false;\r\n  isModal: boolean = false;\r\n  searchText: string;\r\n  windowSize: number = window.innerWidth;\r\n  isOpen: boolean;\r\n  constructor(private activatedRoute: ActivatedRoute,\r\n    private router: Router,\r\n    private kindergartenListService: KindergartenListService,\r\n    private storage: AngularFireStorage) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.windowSize = window.innerWidth;\r\n    this.kindergartenListService.menuPosition.subscribe(res => {\r\n      this.isOpen = res;\r\n    })\r\n    this.backInLocation(true)\r\n    // console.log(moment().format('Do MMMM YYYY'));\r\n    this.getUser();\r\n    this.kindergartenListService.applyFile.subscribe(res => {\r\n      if (res) {\r\n        setTimeout(() => {\r\n          this.getFile(res)\r\n        }, 1000)\r\n      }\r\n    })\r\n  }\r\n\r\n  backInLocation(bool = false) {\r\n    if (!bool) {\r\n      this.router.navigateByUrl('/user/messages')\r\n    }\r\n    this.kindergartenListService.isConversationOpen.next(bool)\r\n  }\r\n\r\n  @HostListener('window:resize', ['$event'])\r\n  onResize(event) {\r\n    this.windowSize = window.innerWidth;\r\n  }\r\n\r\n  ngAfterViewChecked() {\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  scrollToBottom(): void {\r\n    try {\r\n      this.myScrollContainer.nativeElement.scrollTop = this.myScrollContainer.nativeElement.scrollHeight;\r\n    } catch (err) { }\r\n  }\r\n\r\n  getUser(): void {\r\n    if (localStorage.getItem('mainuser')) {\r\n      this.mainUser = JSON.parse(localStorage.getItem('mainuser'));\r\n      this.currMesUser = this.mainUser.contacts.find(res => res.url == this.activatedRoute.snapshot.params.url);\r\n\r\n    }\r\n  }\r\n\r\n\r\n\r\n  getFile(event): void {\r\n    const file = event.target ? event.target.files[0] : event;\r\n    console.log(file);\r\n\r\n    const filePath = `message-file/${file.name}`;\r\n    const upload = this.storage.upload(filePath, file);\r\n    this.isDisabled = true;\r\n\r\n    upload.then(file => {\r\n      this.storage.ref(`message-file/${file.metadata.name}`).getDownloadURL().subscribe(url => {\r\n        this.uplFile = {\r\n          url: url,\r\n          fileName: file.metadata.name\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  downloadFile(file: Files): void {\r\n    var element = document.createElement('a');\r\n    element.setAttribute('href', file.url);\r\n    element.setAttribute('target', '_blank');\r\n    element.setAttribute('download', file.fileName);\r\n    element.style.display = 'none';\r\n    document.body.appendChild(element);\r\n    element.click();\r\n    document.body.removeChild(element);\r\n  }\r\n\r\n  openOption(i: number, e?: Event): void {\r\n    if (this.checkOption == i && this.checkOption !== null) {\r\n      this.onClickedOutsideOption(e, i)\r\n    }\r\n    else {\r\n      this.checkOption = i;\r\n    }\r\n  }\r\n\r\n  onClickedOutsideOption(e: Event, i: number) {\r\n    if (this.checkOption == i && this.checkOption !== null) {\r\n      this.checkOption = null;\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n  editCurrMess(currMes, i): void {\r\n    this.textInput.get('text').patchValue(currMes.text);\r\n    this.editMessage = i;\r\n    this.isEdit = true\r\n    if (currMes.file) {\r\n      this.uplFile = currMes.file;\r\n      this.isDisabled = true\r\n    }\r\n  }\r\n\r\n  deleteCurrMess(i): void {\r\n    this.isModal = true;\r\n    this.deleteIndex = i;\r\n  }\r\n\r\n  // delete(): void {\r\n  //   this.currMesUser.messages.splice(this.deleteIndex, 1);\r\n  //   this.messaging[this.messaging.map((res, i) => { if (res.url == this.currMesUser.url) { return i } })[0]] = this.currMesUser\r\n  //   const user: Users = {\r\n  //     ...this.mainUser,\r\n  //     usersMess: this.messaging\r\n  //   }\r\n  //   localStorage.setItem('mainuser', JSON.stringify(user))\r\n  //   this.authService.update(this.mainUser.id, user).finally(() => {\r\n  //     this.ngOnInit();\r\n  //   })\r\n  //   if (this.allUsers.some(res => res.username == this.currMesUser.name) && this.deleteForm.get('checkbox').value) {\r\n  //     this.updUser();\r\n  //   }\r\n  //   this.closeModal();\r\n  // }\r\n\r\n  // submit(): void {\r\n  //   this.messaging[this.messaging.map((res, i) => { if (res.url == this.currMesUser.url) { return i } })[0]] = this.currMesUser\r\n  //   const user: Users = {\r\n  //     ...this.mainUser,\r\n  //     usersMess: this.messaging\r\n  //   }\r\n  //   localStorage.setItem('mainuser', JSON.stringify(user))\r\n  //   this.authService.update(this.mainUser.id, user).finally(() => {\r\n  //     this.ngOnInit();\r\n  //   })\r\n  //   if (this.allUsers.some(res => res.username == this.currMesUser.name)) {\r\n  //     this.updUser();\r\n  //   }\r\n  // }\r\n\r\n  closeModal(): void {\r\n    this.isModal = false;\r\n    // this.deleteIndex = null;\r\n    this.deleteForm.reset();\r\n  }\r\n\r\n  // updUser(): void {\r\n  //   let reciewUser = this.allUsers.find(res => res.username == this.currMesUser.name);\r\n  //   let index = reciewUser.usersMess.map((res, i) => { if (res.name == this.mainUser.username) { return i } }).filter(res => res)[0]\r\n  //   reciewUser.usersMess[index].messages = this.currMesUser.messages;\r\n  //   this.authService.update(reciewUser.id, reciewUser).finally(() => {\r\n  //     this.ngOnInit();\r\n  //   })\r\n  // }\r\n\r\n  onClickedOutsideItem(e: Event) {\r\n    e.stopPropagation()\r\n    this.closeModal();\r\n  }\r\n\r\n}\r\n","<main class=\"bc-gray flex nowrap jcsb aifs\">\r\n  <section class=\"chat bc-white flex col nowrap jcsb aic\">\r\n    <div class=\"chat__search w-100 flex nowrap jcsa aic\">\r\n      <button class=\"chat__search--back m-l-20 m-r-7 flex nowrap jcc aic icon-arrowhead-thin-outline-to-the-left\"\r\n        (click)=\"backInLocation()\"\r\n        [style.display]=\"(windowSize < 1150 && !isOpen) || windowSize < 945 ? 'flex' : 'none'\">\r\n        <!-- <span aria-hidden=\"true\" class=\"icon-arrowhead-thin-outline-to-the-left\"></span> -->\r\n      </button>\r\n      <span aria-hidden=\"true\" class=\"chat__search--icon icon-icons8-search txt-c-blue\"></span>\r\n      <input type=\"text\" class=\"chat__search--input p-l-10 font-13 bc-white\" [(ngModel)]=\"searchText\" name=\"searchText\"\r\n        placeholder=\"Search this conversation\">\r\n    </div>\r\n    <!-- <div class=\"chat__conversation flex nowrap jcc aicc \" #scroll [scrollTop]=\"scroll.scrollHeight\"> -->\r\n    <div class=\"chat__conversation flex nowrap jcc aicc \" #scroll>\r\n      <div class=\"chat__conversation--text flex col nowrap jcsa aife\">\r\n        <div class=\"w-100 flex col nowrap aife jcsa\" *ngFor=\"let message of currMesUser?.messages; let i=index\">\r\n          <div class=\"message w-100 flex jcsa aifs\" [class]=\"mainUser?.username == message?.user ? 'row-rev' : ''\">\r\n            <img class=\"message__logo\"\r\n              [src]=\"mainUser?.username == message?.user ? message?.userIcon : currMesUser?.img\" alt=\"\">\r\n            <div class=\"message__person-data m-t-3 flex col nowrap jcfs aifs\">\r\n              <p class=\"message__person-data--title m-b-5 m-t-14 w-100\"\r\n                [class]=\"mainUser?.username == message?.user ? 'txt-a-r' : 'txt-a-l'\">\r\n                {{message?.user}}\r\n              </p>\r\n              <p class=\"message__person-data--text m-b-17 w-100 txt-c-black\"\r\n                [class]=\"mainUser?.username == message?.user ? 'txt-a-r' : 'txt-a-l'\">\r\n                <span (click)=\"downloadFile(message?.file)\"\r\n                  class=\"file txt-c-blue w-100\">{{message?.file?.fileName}}</span>\r\n                {{message?.text}}\r\n              </p>\r\n            </div>\r\n            <div class=\"message__other-data flex col nowrap jcfs aifs\">\r\n              <p class=\"message__other-data--time m-b-5 m-t-14 txt-c-initial\">\r\n                {{message?.time}}\r\n              </p>\r\n              <div class=\"option\" (clickOutside)=\"onClickedOutsideOption($event, i)\" (click)=\"openOption(i, $event)\">\r\n                <button class=\"option__button btn bc-white flex aic bc-white icon-more-option\" aria-hidden=\"true\"\r\n                  (mouseover)=\"changeText=i\" [class]=\"(mainUser?.username == message?.user) ? 'jcfs' : 'jcc'\">\r\n                </button>\r\n                <div class=\"option__menu bc-white flex col nowrap jcsa aic\"\r\n                  [style.top]=\"((i === currMesUser?.messages.length-1 && currMesUser?.messages.length > 2) || (i === currMesUser?.messages.length-2 && currMesUser?.messages.length > 3) ) ? '-100px' : '20px'\"\r\n                  [style.left]=\"(mainUser?.username == message?.user) ? '0px' : '-50px'\"\r\n                  [style.height]=\"checkOption == i ? '100px' : '0px'\" [style.z-index]=\"checkOption == i ? '1' : '-1'\"\r\n                  [style.opacity]=\"checkOption == i ? '1' : '0'\">\r\n                  <div class=\"option__menu--items w-100 flex nowrap aic jcc\" (click)=\"editCurrMess(message, i)\"\r\n                    (click)=\"openOption(i,$event)\"> <span aria-hidden=\"true\" class=\"items-edit icon-edit\"></span>\r\n                    <p class=\"items-text font-14 txt-c-initial\">Edit</p>\r\n                  </div>\r\n                  <span class=\"option__menu--line bc-light-gray\"></span>\r\n                  <div class=\"option__menu--items w-100 flex nowrap aic jcc\" (click)=\"deleteCurrMess(i)\"\r\n                    (click)=\"openOption(i,$event)\">\r\n                    <span aria-hidden=\"true\" class=\"items-turn-off icon-turn-off\"></span>\r\n                    <p class=\"items-text font-14 txt-c-initial\">Delete</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!-- <div class=\"w-100\"\r\n              *ngIf=\"+this.currMesUser?.messages[i]?.dateForCheck?.split('/')[2] <= +this.currMesUser?.messages[i+1]?.dateForCheck?.split('/')[2] ; else today\">\r\n              <div class=\"w-100\"\r\n                *ngIf=\"+this.currMesUser?.messages[i]?.dateForCheck?.split('/')[0] <= +this.currMesUser?.messages[i+1]?.dateForCheck?.split('/')[0] ; else today\"> -->\r\n          <div class=\"date-period w-100 flex nowrap jcsa aic\"\r\n            *ngIf=\"(this.currMesUser?.messages[i]?.dateForCheck !== this.currMesUser?.messages[i+1]?.dateForCheck) && this.currMesUser?.messages[i+1]?.dateForCheck\">\r\n            <p class=\"date-period__date m-l-7 m-r-15 txt-c-initial font-12\">\r\n              {{currDate == this.currMesUser?.messages[i+1]?.date ? 'TODAY' : this.currMesUser?.messages[i+1]?.date}}\r\n            </p>\r\n            <hr class=\"date-period__hr w-100\">\r\n          </div>\r\n          <!-- </div>\r\n            </div> -->\r\n\r\n          <!-- <ng-template #today>\r\n              <div class=\"date-period w-100 flex nowrap jcsa aic \"\r\n                *ngIf=\"this.currMesUser?.messages[i+1]?.dateForCheck?.split('/')[1] && (this.currMesUser?.messages[i]?.dateForCheck?.split('/')[1] > this.currMesUser?.messages[i+1]?.dateForCheck?.split('/')[1]) ; else day\">\r\n                <p class=\"date-period__date m-l-7 m-r-15 txt-c-initial font-12\">\r\n                  {{currDate == this.currMesUser?.messages[i+1]?.date ? 'TODAY' : this.currMesUser?.messages[i+1]?.date}}\r\n                </p>\r\n                <hr class=\"date-period__hr w-100\">\r\n              </div>\r\n            </ng-template>\r\n            <ng-template #day>\r\n              <div class=\"date-period w-100 flex nowrap jcsa aic \"\r\n                *ngIf=\"this.currMesUser?.messages[i]?.dateForCheck?.split('/')[1] < this.currMesUser?.messages[i+1]?.dateForCheck?.split('/')[1]\">\r\n                <p class=\"date-period__date m-l-7 m-r-15 txt-c-initial font-12\">\r\n                  {{currDate == this.currMesUser?.messages[i+1]?.date ? 'TODAY' : this.currMesUser?.messages[i+1]?.date}}\r\n                </p>\r\n                <hr class=\"date-period__hr w-100\">\r\n              </div>\r\n            </ng-template> -->\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"chat__message bc-light-blue flex nowrap jcsb aic w-100\" [formGroup]=\"textInput\">\r\n      <div class=\"chat__message--upload flex wrap aic jcc\">\r\n        <div class=\"upload-btn-wrapper m-l-5\">\r\n          <button class=\"btn flex wrap aic jcsa font-12\">\r\n            <span aria-hidden=\"true\" class=\"btn__paper-clip icon-paper-clip\"></span>\r\n            <span class=\"btn__isfile bc-red\" *ngIf=\"uplFile\"></span>\r\n          </button>\r\n          <input type=\"file\" name=\"myfile\" (change)=\"getFile($event)\">\r\n        </div>\r\n      </div>\r\n      <input type=\"text\" class=\"chat__message--input p-l-10 bdc-light-gray\" formControlName=\"text\"\r\n        placeholder=\"Write a message...\">\r\n\r\n      <button class=\"chat__message--send m-l-10 m-r-10 font-13\" *ngIf=\"!isEdit\"\r\n        [class]=\"!isDisabled ? 'bc-dark-gray' : 'bc-blue'\" [disabled]=\"!isDisabled\" (click)=\"sendMessage()\">\r\n        Send </button>\r\n      <button class=\"chat__message--send m-l-10 m-r-10 font-13\" *ngIf=\"isEdit\"\r\n        [class]=\"!isDisabled ? 'bc-dark-gray' : 'bc-blue'\" [disabled]=\"!isDisabled\" (click)=\"sendEditMessage()\">\r\n        Edit </button>\r\n    </div>\r\n  </section>\r\n\r\n  <section class=\"modal w-100 flex aic jcc nowrap\" *ngIf=\"isModal\">\r\n    <div class=\"modal__block flex col aic jcsb p-10\" (clickOutside)=\"onClickedOutsideItem($event)\">\r\n      <div class=\"modal__block--cross w-100 flex m-t-4 m-r-4 aic jcfe\" (click)=\"closeModal()\">\r\n        <span class=\"icon-close\"></span>\r\n      </div>\r\n      <div class=\"modal__block--title w-100 flex aic jcc nowrap txt-c-blue font-25\">Delete message</div>\r\n      <div class=\"modal__block--text w-100 flex aic jcc nowrap font-20 txt-c-black\">Do you really want to delete this\r\n        message?</div>\r\n      <div class=\"w-100 flex nowrap aic jcc\" [formGroup]=\"deleteForm\">\r\n        <input type=\"checkbox\" class=\"checkbox\" formControlName=\"checkbox\">\r\n        <p class=\"font-16 m-l-20\">Also delete for {{currMesUser?.name}}</p>\r\n      </div>\r\n      <div class=\"modal__block--button m-b-35 flex aic jcc nowrap\"><button\r\n          class=\"btn cancel bc-blue bdc-blue m-r-10 font-13 txt-c-white\" (click)=\"closeModal()\">Cancel</button> <button\r\n          class=\"submit btn bc-red bdc-red font-13\" (click)=\"delete()\">Delete</button></div>\r\n    </div>\r\n  </section>\r\n</main>\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { MessagesChatComponent } from './messages-chat/messages-chat.component';\r\nimport { MessagesComponent } from './messages.component';\r\n\r\n\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: MessagesComponent,\r\n        children: [\r\n            {\r\n                path: ':url',\r\n                component: MessagesChatComponent\r\n            }\r\n        ]\r\n    },\r\n\r\n];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n})\r\nexport class MessagesRoutingModule { }","\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { DateAdapter, MatNativeDateModule, MAT_DATE_FORMATS, MAT_DATE_LOCALE } from '@angular/material/core';\r\nimport { MomentDateAdapter } from '@angular/material-moment-adapter';\r\nimport { MY_FORMATS } from 'src/app/shared/const/myformat';\r\nimport { SharedModule } from 'src/app/shared/shared.module';\r\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\r\nimport { ClickOutsideModule } from 'ng-click-outside';\r\nimport { MessagesRoutingModule } from './messages-routing.module';\r\nimport { MessagesChatComponent } from './messages-chat/messages-chat.component';\r\n\r\n\r\n@NgModule({\r\n    declarations: [\r\n    MessagesChatComponent\r\n  ],\r\n    imports: [\r\n        CommonModule,\r\n        MessagesRoutingModule,\r\n        SharedModule,\r\n        FormsModule,\r\n        ReactiveFormsModule,\r\n        MatProgressSpinnerModule,\r\n        ClickOutsideModule,\r\n    ],\r\n    providers: [\r\n        { provide: DateAdapter, useClass: MomentDateAdapter, deps: [MAT_DATE_LOCALE] },\r\n        { provide: MAT_DATE_FORMATS, useValue: MY_FORMATS }\r\n    ],\r\n})\r\nexport class MessagesModule { }"],"names":[],"sourceRoot":"webpack:///"}