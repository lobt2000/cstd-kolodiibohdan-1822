<main class="main-block" #content [formGroup]="kindergarten">
  <section class="header-block">
    <div class="input">
      <div class="input__upload">
        <div class="upload-btn-wrapper">
          <button *ngIf="!kindergarten.value?.backgroundImg" class="btn">Upload blog Image</button>
          <div *ngIf="kindergarten.value?.backgroundImg"
            [style.background-image]="'url(' + (kindergarten.value?.backgroundImg || 'https://firebasestorage.googleapis.com/v0/b/kindergarten-daed8.appspot.com/o/image%2FbacgroundImg.jpg?alt=media&token=b106542f-b902-4200-a394-e8255aba22ab') + ')'"
            class="img"></div>
          <input type="file" name="myfile" />
        </div>
      </div>
    </div>
    <div class="header-title">
      <div class="text">
        <textarea type="text"
          [style.color]="kindergarten.value?.titleColor ? (kindergarten.value?.titleColor + '!important') : '#ec2F4B'"
          [formControlName]="'title'" class="title-text" placeholder="Write here your title" maxlength="40"></textarea>
        <div class="choose-color" [matTooltip]="'Click to rainbow to choose title color'"
          (clickOutside)="onClickedOutsideItem($event, 'titleColor')" [matTooltipPosition]="'below'"
          matTooltipClass="mat-custom-tooltip-below" (click)="chooseTitleColor=true">
          <div class="color-rainbow" [style.display]="chooseTitleColor ? 'flex' : 'none'">
            <div class="write-color">
              <input type="text" placeholder="write here title color(hex)" [formControlName]="'titleColor'">
            </div>
            <div class="color-range">
              <div *ngFor="let item of items" [style.background-color]="item"
                (mouseover)="changeColor(item, 'titleColor')" (click)="onClickedOutsideItem($event, 'titleColor')">
              </div>
            </div>
          </div>
        </div>

      </div>
      <button class="btn record"
        [ngStyle]="{'background-color': (kindergarten.value?.titleButtonColor || 'green'), 'color' : (kindergarten.value?.titleButtonTextColor || 'white')}"
        [matTooltip]="'Click on the button to choose the title color'" [matTooltipPosition]="'below'"
        matTooltipClass="mat-custom-tooltip-below" (clickOutside)="onClickedOutsideItem($event, 'titleButtonColor')"
        (click)="$event.target['className'].includes('choose-color') ? chooseTitleButtonColor=false : chooseTitleButtonColor=true">Apply
        to kindergarten
        <div class="choose-color" [matTooltip]="'Click to rainbow to choose title color'"
          (clickOutside)="onClickedOutsideItem($event, 'titleButtonTextColor')" [matTooltipPosition]="'below'"
          matTooltipClass="mat-custom-tooltip-below" (click)="chooseTitleButtonTextColor=true">
          <div class="color-rainbow" [style.display]="chooseTitleButtonTextColor ? 'flex' : 'none'">
            <div class="write-color">
              <input type="text" placeholder="write here title color(hex)" [formControlName]="'titleButtonTextColor'">
            </div>
            <div class="color-range">
              <div *ngFor="let item of items" [style.background-color]="item"
                (mouseover)="changeColor(item, 'titleButtonTextColor')"
                (click)="onClickedOutsideItem($event, 'titleButtonTextColor')"></div>
            </div>
          </div>
        </div>
        <div class="color-rainbow" [style.display]="chooseTitleButtonColor ? 'flex' : 'none'">
          <div class="write-color">
            <input type="text" placeholder="write here title color(hex)" [formControlName]="'titleButtonColor'">
          </div>
          <div class="color-range">
            <div *ngFor="let item of items" [style.background-color]="item"
              (mouseover)="changeColor(item, 'titleButtonColor')"
              (click)="onClickedOutsideItem($event, 'titleButtonColor')"></div>
          </div>
        </div>
      </button>
      <span class="arrow"></span>
    </div>
  </section>
  <!-- <section class="description-block"
      [style.flex-flow]="(windowSize < 1120 && !isOpen) || windowSize < 850 ? 'column' : 'row'">
      <img class="description-logo" [src]="currkinder?.descriptionImg" alt=""
        [style.margin-bottom]="(windowSize < 1120 && !isOpen) || windowSize < 850 ? '40px' : '0px'">
      <div class="description-text" [innerHTML]="currkinder?.descriptionText"
        [style.width]="(windowSize < 1120 && !isOpen) || windowSize < 850 ? '90%' : '48%'"></div>
    </section>
    <section class="group-block" *ngIf="currkinder?.kindergartenGroup">
      <div class="group-content" *ngFor="let item of currkinder?.kindergartenGroup">
        <div class="group-img"
          [style.background-image]="'url(' + (item?.groupImg || 'assets/image/nursery-group-default.jpg') + ')'">
        </div>
        <div class="group-info">
          <div class="group-name">{{item?.name}}</div>
          <div class="group-age-range">{{item?.ageRange}}</div>
          <button class="group-detail">Go to Details</button>
        </div>
      </div>
    </section>
    <div class="advantage-header" *ngIf="currkinder?.kinderAdvantages">Why {{currkinder?.title}}</div>
    <section class="advantage-block" *ngIf="currkinder?.kinderAdvantages">
      <div class="advantage-content" *ngFor="let advantage of currkinder?.kinderAdvantages; let i=index">
        <div class="advantage-title"><span [class]="advantage?.numImg ? 'numImg' : 'number'"
            [style.background-image]="'url(' + (advantage?.numImg || '') + ')'">{{advantage?.numImg ? '' : (i+1)}}</span><span
            class="title">{{advantage.title}}</span>
        </div>
        <div class="advantage-text">{{advantage.text}}</div>
      </div>
    </section>
  
    <section class="address-block" *ngIf="currkinder?.kinderAddresses">
      <div class="address-header">{{currkinder?.title}} addresses</div>
      <div class="address-container"
        [style.background-image]="'url(' + ( currkinder?.addressBackground || 'assets/image/addresses-background.jpg') + ')'">
        <div class="address-content" *ngFor="let kinderAddress of currkinder?.kinderAddresses">
          <span class="address-pos"
            [style.background-image]="'url(' + ( kinderAddress.addressPosImg || 'assets/image/crown.jpg') + ')'"></span>
          <span class="address-name">{{kinderAddress?.addressName}}</span>
        </div>
      </div>
    </section>
  
    <section class="form-block" *ngIf="currkinder?.kinderForm">
      <div class="form-header">Forms of stay in {{currkinder?.title}}</div>
      <div class="form-container">
        <div class="form-content" *ngFor="let form of currkinder?.kinderForm">
          <div class="form-title-info">
            <div class="form-title-type">{{form?.formTitleType}}</div>
            <div class="form-title-time">{{form?.formTitleTime}}</div>
            <div class="form-title-price">{{form?.formTitlePrice}}</div>
            <div class="form-title-additional">{{form?.formTitleAdditional}}</div>
          </div>
          <div class="form-description-block">
            <div class="form-description-content" *ngFor="let description of form?.formDescription; let j=index">
              <span [class]="description?.numImg ? 'form-pos-img' : 'form-pos-num'"
                [style.background-image]="'url(' + (description?.numImg || '') + ')'">{{description?.numImg ? '' : '‚ù§'}}</span>
              <span class="form-name">{{description.descText}}</span>
            </div>
            <div class="form-description-button">
              <button class="ask-for-details btn">Ask for details</button>
              <button class="recort-to-kinder btn" (click)="goToApply()">Apply into group</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  
    <section class="child-registr-block">
      <div class="child-registr-header">Fill out the form</div>
      <form class="child-registr-form" [formGroup]="form">
        <div class="form-elem">
          <label for="">Your first name</label>
          <input type="text" [formControlName]="'firstName'"
            [style.border-bottom]="form.get('firstName').valid ? '' : '2px solid red'">
          <span *ngIf="this.form.get('firstName').getError('required')">Field should be required</span>
        </div>
        <div class="form-elem">
          <label for="">Your last name</label>
          <input type="text" [formControlName]="'lastName'"
            [style.border-bottom]="form.get('lastName').valid ? '' : '2px solid red'">
          <span *ngIf="this.form.get('lastName').getError('required')">Field should be required</span>
        </div>
        <div class="form-elem">
          <label for="">Your email</label>
          <input type="text" [formControlName]="'email'"
            [style.border-bottom]="form.get('email').valid ? '' : '2px solid red'">
          <span *ngIf="this.form.get('email').getError('required')">Field should be required</span>
        </div>
        <div class="form-elem">
          <label for="">Your child name</label>
          <input type="text" [formControlName]="'childName'"
            [style.border-bottom]="form.get('childName').valid ? '' : '2px solid red'">
          <span *ngIf="this.form.get('childName').getError('required')">Field should be required</span>
        </div>
        <div class="form-elem">
          <label for="">Your child year old</label>
          <input type="number" [formControlName]="'childYear'" min="1" max="6"
            [style.border-bottom]="form.get('childYear').valid ? '' : '2px solid red'">
          <span *ngIf="this.form.get('childYear').getError('required')">Field should be required</span>
        </div>
        <div class="form-elem">
          <label for="">Your child sex</label>
          <input type="text" [formControlName]="'childSex'"
            [style.border-bottom]="form.get('childSex').valid ? '' : '2px solid red'">
          <span *ngIf="this.form.get('childSex').getError('required')">Field should be required</span>
        </div>
        <div class="form-elem" *ngIf="currkinder?.kindergartenGroup">
          <label>Choose group</label>
          <div class="form-elem-select p-l-0 p-r-5 flex wrap aic bc-white"
            (clickOutside)="onClickedOutsideItem($event, 'groupType')" (click)="openHidden('groupType')"
            [style.border-bottom]="form.get('groupType')?.valid ? '' : '2px solid red'">
            <div class="choose-sort p-4 m-l-5 flex nowrap jcsa aic bc-gray"
              [innerHTML]="form.get('groupType').value.name">
            </div>
            <span class="error" *ngIf="this.form.get('groupType').getError('required')">Field should be required</span>
            <span aria-hidden="true" data-icon="&#xe900;"
              [class]="!isGroupCheck ? 'icon-drop-down-arrow' : 'icon-drop-up-arrow'" class="drop-icon"></span>
            <div class="hidden bc-white" [style.display]="isGroupCheck ? 'flex' : 'none'"
              [style.transition]="'display 300ms ease-in-out'">
              <p class="p-l-10 txt-c-black font-16" *ngFor="let item of currkinder?.kindergartenGroup; let i=index;"
                (click)="groupCheckType(item, 'groupType')"
                [style.border-bottom]="i == currkinder?.kindergartenGroup.length-1 ? 'none' : ''">
                {{item?.name}}</p>
            </div>
          </div>
        </div>
        <div class="form-elem" *ngIf="currkinder?.kinderForm">
          <label>Choose form of stay</label>
          <div class="form-elem-select p-l-0 p-r-5 flex wrap aic bc-white"
            (clickOutside)="onClickedOutsideItem($event, 'typeOfReg')" (click)="openHidden('typeOfReg')"
            [style.border-bottom]="form.get('typeOfReg').valid ? '' : '2px solid red'">
            <div class="choose-sort p-4 m-l-5 flex nowrap jcsa aic bc-gray"
              [innerHTML]="form.get('typeOfReg').value.formTitleType">
            </div>
            <span class="error" *ngIf="this.form.get('typeOfReg').getError('required')">Field should be required</span>
            <span aria-hidden="true" data-icon="&#xe900;"
              [class]="!isType ? 'icon-drop-down-arrow' : 'icon-drop-up-arrow'" class="drop-icon"></span>
            <div class="hidden bc-white" [style.display]="isType ? 'flex' : 'none'"
              [style.transition]="'display 300ms ease-in-out'">
              <p class="p-l-10 txt-c-black font-16" *ngFor="let item of currkinder?.kinderForm; let i=index;"
                (click)="groupCheckType(item, 'typeOfReg')"
                [style.border-bottom]="i == currkinder?.kinderForm-1 ? 'none' : ''">
                {{item?.formTitleType}}</p>
            </div>
          </div>
        </div>
  
      </form>
      <button class="btn send-child-registr-form" (click)="sendApply()">Send registration form</button>
    </section> -->

</main>
<div *ngIf="isLoading" class="loader-overlay">
  <mat-spinner></mat-spinner>
</div>
